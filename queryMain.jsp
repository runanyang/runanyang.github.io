

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">
    <link rel="stylesheet" type="text/css" href="css/reset.css"/>
    <link rel="stylesheet" href="css/weui.min.css?rff=dsfffsdf">
    <link rel="stylesheet" href="css/fund-ui-form.css"/>
    <link rel="stylesheet" href="css/yinhai.css?sd=d">
    <link rel="stylesheet" href="css/weui.min.css"/>
    



<script type="text/javascript">
    
     var global ={"newsevent":"无","im":"无","city":"长沙住房公积金管理中心","imcustmsg":"","workguid":"http://www.gdzwfw.gov.cn/portal/affairs-public-depart-matters?region=440800999999999=45625026X","newssurvey":"无","phone2":"12329","newslodge":"无","newspolicy":"http://www.zjzfgjj.gov.cn/fileserver/NewsHtml/bd42aecb-b38d-4de3-b5fe-ddf515e556d9.html","newshot":"http://m.zjzfgjj.gov.cn/Modules/Wap/NewsList.aspx?cid=5dc8ad6b-a1f6-4911-83ac-4dbc1d52abee","web":"http://35.10.43.245/interface/phoneInteface.jsp","phone":"12329","WEIXIN_URL":"http://wx.scsjgjj.com/mobileApp","sinaWeibo":"","myzixun":"http://www.zjzfgjj.gov.cn/fileserver/NewsHtml/bd42aecb-b38d-4de3-b5fe-ddf515e556d9.html","myadvisory":""};
    
    var  gloalPath=window.location.protocol+"//"+window.location.host+"/mobileApp/";
    var basePath="/mobileApp/";
    var pwd_reg="^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@!%*#?&])[A-Za-z\d@$!%*#?&]{8,16}$";
    gobackurl="indexAbout.jsp";
    Base={gobackurl:"indexAbout.jsp"};//针对慧眼刷脸跳转页面（防止重复刷新）
</script>
<link rel="stylesheet" href="../weixin/css/fonts/font-awesome.min.css?r=dsfsdf">
<link rel="stylesheet" href="../weixin/css/base.css?r=dsfsdf">
<link rel="stylesheet" href="../weixin/css/yinhai.css?rff=d3sfffs">
<script src="../weixin/js/jquery-1.11.1.min.js?r=dsfsdf"></script>
<script src="../weixin/js/layer/layer.js?r=dsfsdf"></script>
<script src="../weixin/js/yinhai.js?rd=2333245"></script>
<script src="../weixin/js/netutil.js?r=1"></script>
<script src="../weixin/js/core-min.js"></script>
<script src="../weixin/js/weui.min.js"></script>
<script src="../weixin/js/enc-base64.js"></script>
<script src="../weixin/js/jsencrypt.js"></script>
<script src="../weixin/js/security.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
    <title>长沙住房公积金管理中心
    </title>
    





    <style type="text/css">
        html, body {
            width: 100%;
            height: 100%;
            background-color: #fff;
        }

        .top {
            width: 100%;
            height: 14.7rem;
            background: url(css/img/self_f.png) no-repeat;
            background-size: 100% 100%;
            border-bottom: solid 0.9rem #F7F7F7;
        }

        .top_title {
            width: 92%;
            height: 3rem;
            margin: 0 auto;
            padding-top: 2.2rem;
            display: flex;
            justify-content: space-between;
        }

        .top_title .title_item {
            width: 30%;
            height: 100%;
        }

        .top_title .title_item img {
            width: 1.1rem;
            height: 1.1rem;
        }

        .top_title .title_items {
            color: #FFFFFF;
            text-align: center;
            font-size: 1.2rem;
        }

        .top_title .title_itemt {
            display: flex;
            justify-content: flex-end;
        }

        .name_part {
            width: 92%;
            height: 2.5rem;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            font-size: 1rem;
            color: #fff;
        }

        .name_part .name_left {
            font-weight: bold;
        }

        .align_txt {
            width: 100%;
            height: 2.4rem;
            text-align: center;
            color: #FFFFFF;
            font-size: 0.9rem;
        }

        .detai {
            width: 100%;

            height: 2.2rem;
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            color: #FFFFFF;
        }

        .voice {
            width: 100%;
            height: 8rem;
            background: url(css/img/self_fi.png) no-repeat;
            background-size: 100% 100%;
            margin-top: -4rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .voice .voice_center {
            width: 78%;
            height: 2rem;
            display: flex;
            justify-content: flex-start;
        }

        .voice .voice_center .center_left {
            width: 10%;
            height: 100%;
            display: flex;
            align-items: center;
        }

        .voice .voice_center .center_left img {
            width: 1.2rem;
            height: 1.2rem;
        }

        .voice .voice_center .center_right {
            width: 90%;
            height: 100%;
            display: flex;
            color: #444;
            font-size: .8rem;
            align-items: center;
        }

        .button_four {
            width: 100%;
            height: 5.8rem;
            margin-top: .6rem;
            color: #666;
            font-size: 0.8rem;
            border-bottom: solid 0.9rem #F7F7F7;
            display: flex;
            justify-content: flex-start;

        }

        .button_four .four_items {
            width: 25%;
            height: 100%;
            text-align: center;
        }

        .button_four .four_items .item_up {
            width: 100%;
            height: 3.75rem;
            display: flex;
            justify-content: center;
        }

        .button_four .four_items .item_up img {
            width: 3.1rem;
            height: 3.1rem;
        }

        .reserve {
            width: 100%;
            height: 8rem;
            border-bottom: solid 0.9rem #f7f7f7;
        }

        .reserve .reserve_in {
            width: 92%;
            height: 100%;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #999;
        }

        .reserve .reserve_in .in_items {
            width: 50%;
            height: 100%;
            display: flex;
            justify-content: space-around;

        }

        .reserve .reserve_in .in_items .item_left {
            padding-top: 1rem;
            width: 50%;
            height: 100%;

        }

        .reserve .reserve_in .in_items .item_left img {
            width: 4rem;
            height: 0.8rem;
            margin: 1.6rem 0 0.5rem 0.5rem;
        }

        .reserve .reserve_in .in_items .item_right {
            width: 50%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;

        }

        .reserve .reserve_in .in_items .item_right img {
            width: 4.4rem;
            height: 3rem;
        }

        .button_four .four_items {
            width: 33.3%; /*一行四个25%，一行三个3333%*/
            height: 4.5rem;
            float: left;
        }

        .icons {
            text-align: center;
            padding-top: 0.5rem;
            padding-bottom: 0.8rem;
        }

        .icons .icon_img img {
            width: 2.3rem;
            height: 2.3rem;
        }
        .icons .icon_text {
            font-size: 0.8rem;
            color: #444444;
        }
        .bord {
            border-top: solid 0.5rem #F7F7F7;
        }
        .font8b {
            font-size: 0.9rem;
            font-weight: bold;
            color: #444444;
            margin-left: 0.5rem;
        }
        .weui-flex__item{
            display: inline-block;
            width: 33%;
        }
        .down-box{
            outline: none;border: 0px;border-radius: 5px;-webkit-border-radius: 5px;color: #fff;font-size: 1.1em;height: 3.2em;width: 100%;background: #52a7ea;
        }
        .down-box-select{
            background-color: #3b91de;
        }
        .third-box{display:none;border:1px solid #fe771b;margin-top:10px;border-radius: 5px}
        .icons{ text-align: center;padding-top:0.5rem;padding-bottom: 0.8rem;}
        .icons .icon_img img{ width: 1.7rem; height: 1.7rem;   }
        .icons .icon_text{font-size: 0.8rem;color: #444444;}
        .bord{border-top: solid 0.5rem #F7F7F7;
        }
        .bor::before{ border: none;}
        .font8b{font-size: 0.9rem;font-weight: bold;color: #444444;margin-left: 0.5rem;}

    </style>
</head>
<body ontouchstart>
<div>
    <!--顶部的部分-->
    <div class="top">
        <!--标题部分-->
        <div class="top_title">
            <div class="title_item title_itemf ">
                <img style='display:none' src="css/img/self_tr.png"/>
            </div>
            <div class="title_items">
                我的公积金
            </div>
            <div class="title_item title_itemt">
                <img style='display:none' src="css/img/self_fo.png"/>
            </div>
        </div>
        <!--个人姓名部分-->
        <div class="name_part">
            <div class="name_left">
                姓名：<span id='pername'></span>
            </div>
            <div class="name_right">
                个人账号：<span id='peracc'></span>
            </div>
        </div>
        <!--中间的-->
        <div class="align_txt">
            账户余额
        </div>
        <!--具体的数据-->
        <div id="accbal" class="detai">
        </div>
    </div>
    <!--通告部分-->
    <div class="voice" style="display:none;">
        <div class="voice_center">
            <div class="center_left">
                <img src="css/img/self_si.png"/>
            </div>
            <div class="center_right" id="newschange" onclick="$.openWin('perSubMsgList.jsp','消息提醒')">
                长沙市公积金微信应用上线
            </div>
        </div>
    </div>
    <!--四个按钮部分-->
    <div id="jc_menus" style="display:none;">
        <div class="weui-cell bor">
            <div class="weui-cell__hd">
                <img src="css/images/anniuu.png" style="height: 0.8rem;">
            </div>
            <div class="weui-cell__bd">
                <p class="font8b">账户查询</p>
            </div>
        </div>
        <div class="weui-flexs">
            <!--这里面动态加载菜单-->
        </div>
    </div>
    <div id="dk_menus" style="display:none;">
        <div class="weui-cell bor bord">
            <div class="weui-cell__hd">
                <img src="css/images/anniuu.png" style="height: 0.8rem;">
            </div>
            <div class="weui-cell__bd">
                <p class="font8b">贷款查询</p>
            </div>
        </div>
        <div class="weui-flexs" style="min-height:130px">
            <!--这里面动态加载菜单-->
        </div>
    </div>
    <div id="dy_menus" style="display:none;">
        <div class="weui-cell bor bord">
            <div class="weui-cell__hd">
                <img src="css/images/anniuu.png" style="height: 0.8rem;">
            </div>
            <div class="weui-cell__bd">
                <p class="font8b">下载打印</p>
            </div>
        </div>
        <div class="weui-flexs" style="min-height:130px">
            <!--这里面动态加载菜单-->
        </div>
    </div>
</div>



<style>
  .bar_index_0{color:#00A1EA}
</style>

<div class="weui-tabbar" style='position:fixed;padding-bottom:.0rem;padding-top:.0rem;bottom:0px;width:100%'>
                <a href="queryMain.jsp?a=0" class="weui-tabbar__item ">
                    <div class=" fa fa-home bar_index_0"  style='font-size:1.1rem'></div>
                    <p style="font-size:.825rem;" class="weui-tabbar__label bar_index_0">首页</p>
                </a>
                <a href="bussness.jsp?a=1" class="weui-tabbar__item ">
                    <div class=" fa fa-briefcase bar_index_1"  style='font-size:1rem'></div>
                    <p style="font-size:.825rem" class="weui-tabbar__label bar_index_1">业务</p>
                </a>
                <a href="indexTools.jsp?a=2" class="weui-tabbar__item ">
                    <div class=" fa fa-newspaper-o bar_index_2"  style='font-size:1rem'></div>
                    <p style="font-size:.825rem" class="weui-tabbar__label bar_index_2">工具</p>
                </a>
                <a href="indexAbout.jsp" class="weui-tabbar__item ">
                    <div class=" fa fa-user bar_index_3"  style='font-size:1rem'></div>
                    <p style="font-size:.825rem" class="weui-tabbar__label bar_index_3">我的</p>
                </a>
</div>     
<script>
document.addEventListener('WeixinJSBridgeReady', function () {
   WeixinJSBridge.call('hideToolbar');
});
</script> 

</body>
<script type="text/javascript">
    $(document).ready(function () {
        getMenuList();
        initInfo();
        $.remove("year");
        $(".circle").remove();
    });

    function initInfo() {
        getUserInfo();

    }

    function getMenuList() {
        var p = {"method": "user.getMenusList", "v": "1.0", "tab": "first"};
        $.doSubmit("", p, function (data) {
            var jc_query_menus = data.jc_query_menus;
            var dk_query_menus = data.dk_query_menus;
            var dy_query_menus = data.dy_query_menus;
            fetchMenu(jc_query_menus, "jc_menus");
            fetchMenu(dk_query_menus, "dk_menus");
            fetchMenu(dy_query_menus, "dy_menus");
            activeUrl();
        }, function (data) {
            $.toast(data.resmsg);
        });
    }

    function getUserInfo() {
        $.doSubmit("", {"toast": 0, "sw": "0", "method": "user.perInfo", "v": "1.0"}, function (data) {
            depData = data;
            for (var i = 0; i < depData.acct.length; i++) {
                depData.acct[i].email = depData.email || "";
                depData.acct[i].bkcardname = depData.bkcardname || "";
                depData.acct[i].bkcard = depData.bkcard || "";
            }
            fillData(depData);
            $.val("userInfo_data", depData);
            var perInfo = [{"name": "姓名", "value": depData.pername},
                {"name": "性别", "value": depData.sex},
                {"name": "身份证号", "value": depData.codeno},
                {"name": "出生日期", "value": depData.birthday},
                {"name": "手机号码", "value": depData.phone}
            ];
            $.val("_perInfo", perInfo);
            getMsg();
            md.execScript({name: "root", frameName: "tab1", script: "initUserInfo()"});
        }, function (data) {
            $.toast(data.resmsg);
        }, function () {
            $.toast(data.resmsg);
        });
    }

    function fillData(data) {
        $("#pername").text(data.pername);
        $("#peracc").text(data.peracc);
        $("#accstate").text(data.accstate);
        var accbal = 0;

        for (var i = 0; i < data.acct.length; i++) {
            accbal += Number(data.acct[i].accbal);
        }

        $.val("__accbal", accbal);//
        accbal = $.dataFormat(accbal + "") + "元";
        $("#accbal").text(accbal);
        $("#loginbtn").hide();
        $("#per_info").show();
    }

    function getMsg() {
        $.doSubmit("", {"toast": 0, "method": "user.getMsgList", "v": "1.0"}, function (data) {
            if (data.list && data.list.length >= 1) {
                dataList = data.list;
                var msg = "";
                $("#newschange").empty();
                for (var i = 0; i < dataList.length; i++) {
                    var item = dataList[i];
                    /*
                    msg+="<div >";
                    msg+=	"<span class='radius'></span>";
                    msg+=	"<span>"+item.msgtitle+"</span>";
                    msg+="</div>";
                    */
                    var msgcontent = item.msgcontent;
                    if (msgcontent && msgcontent.length >= 46) {
                        msgcontent = msgcontent.substring(0, 46) + "...";
                    }
                    $("#newschange").append(msgcontent);
                    msg = "";
                    if (i == 0) {
                        break;
                    }
                }
            }
            initnews();
        });
    }

    function activeUrl() {
        $(".shortcut").bind("click", function () {
            var url = $(this).attr("data-url");
            if("print"==url){
                $(this).bind('click',fnOpenWin());
            }else{
                $.openWin(url, $(this).find(".icon_text").text());
            }
        });
    }

    function doscan() {
        scanner.open({
            autorotation: true
        }, function (ret, err) {
            if (ret.content) {
                doconfirm(ret.content);
            }
        });
    }

    function doconfirm(content) {
        var p = {"tokencode": content, "method": "user.qrscann", "v": "1.0"};
        $.doSubmit("", p, function (data) {
            if (data.static == 0) {
                $.toast("二维码过期");
            } else {
                $.openWin("pclogin.jsp", "确认登录");
                $.val("_token", content);
            }
        }, function (data) {
            $.toast(data.resmsg);
        });
    }


    function login() {
        $.openWin("login.jsp", "", false, true);
    }

    function initnews() {
        var newslist = $.val("_newslist");
        if (newslist) {
            newslist = $.parseJSON(newslist);
            fillNews(newslist);
        }
        var p = {toast: 0, "method": "user.newslist", "v": "1.0"};
        $.doSubmit("", p, function (data) {
            fillNews(data.list);
            $.val("_newslist", data.list);
        }, function (data) {
            $.toast(data.resmsg);
        });
    }

    function fillNews(list) {
        var len = list.length;
        var html = "";
        for (var i = 0; i < len; i++) {
            var item = list[i];
            html += "<div  class='weui-media-box media-padd weui-media-box_appmsg' >"
            html += "  <div class='weui-media-box__bd newslist' data-url='" + item.url + "' >";
            html += "     <p style='font-size:14px'>" + item.newstitle + "</p>";
            html += "  </div>";
            html += "</div>";
        }
        $("#newsrecord").html(html);
        $(".newslist").unbind();
        $(".newslist").bind("click", function () {
            var url = $(this).attr("data-url");
            $.val("_newsurl", url);
            $.openWin("news.jsp", "新闻");
        });
    }

    function getAviBanlace() {
        $.doSubmit("", {"toast": 0, "method": "user.avabanlance", "v": "1.0"}, function (data) {
            var accbal = data.mny;
            $.val("__accbal", data.mny);//
            accbal = $.dataFormat(accbal + "") + "元";
            $("#accbal").text(accbal);
        }, function (data) {
            //$.toast(data.resmsg);
        }, function () {
            //$.toast(data.resmsg);
        });
    }

    function layout() {
        var h = $(window).height() - $("#funbox").height() - 14;
        $("#newsrecord").height(h);
    }

    layout();
    var bustype = "";//选中打印类型
    function fnOpenWin() {
        var html = "<div id='tab_one' onclick='fnGetDataToOpen(\"01\")' class='box box-c down-box'><div>安顺市公积金账户证明下载</div></div>"
        html += "<div id='tab_two' onclick='fnGetDataToOpen(\"02\")' style='margin-top: 20px;' class='box box-c down-box'><div>异地贷款公积金缴存证明下载</div></div>"
        html += "<div class='weui-cell third-box' id='third_box'><select   class='weui-select' id='outfundname' placeholder='请输入异地缴存中心名称' >"
        html +=    "<option value=''>请选择异地中心</option><option value='00000392'>成都中心</option></select></div>"
        html += "<div class='box box-c'>\
        <div  class='corp-name element-hidden' style='width: 100%;'>\
            <select id='cxsjlx' name='cxsjlx' style='width: 98%;font-size: .9375em;height: 2.3em;margin-top: 1em;' label='缴存明细查询时间段'>\
            <option value='1'>近一年</option>\
            <option value='2'>近两年</option>\
            <option value='3'>近三年</option>\
            </select>\
        </div>\
        </div>"
        $.dialog({title: "", content: html, mode: 0}, function (index) {
            var cxsjlx = $("#cxsjlx").val();
            if(index==1){
                if(bustype=="01"){
                    $.doSubmit("", {"toast": 0, "method": "user.testIndexCode", "v": "1.0", "jczmlx": "01","cxsjlx":cxsjlx,"depprinttype":"01"}, function (data) {
                        var parameters = {"type": "BDJCZMDY", "buscode": data.buscode, "title": "个人缴存证明-网厅", "exptype": "2"};
                        reportGenerator(parameters);
                    }, function (data) {
                        $.toast(data.resmsg);
                    }, function () {
                        $.toast(data.resmsg);
                    });
                }else if(bustype=="02"){
                    var dfzxbh = $("#outfundname").val();
                    if (dfzxbh == null || dfzxbh.trim() == "") {
                        $.toast("请选择异地缴存中心");
                        return true;
                    }
                    var dfzxbhtext = $('#outfundname option:selected').text();//选中的文本
                    $.dialog({title: "", content: "你确定要打印【"+dfzxbhtext+"】异地缴存证明吗？", mode: 0}, function (index) {
                        if(index==1){
                            $.doSubmit("", {"toast": 0, "method": "user.testIndexCode", "v": "1.0", "jczmlx": "02", "outfundname": dfzxbhtext,"cxsjlx":cxsjlx,"depprinttype":"02","dfzxbh":dfzxbh}, function (data) {
                                var parameters = {"type": "YDJCZMDY", "buscode": data.buscode, "title": "个人缴存证明-网厅", "exptype": "2"};
                                reportGenerator(parameters);
                            }, function (data) {
                                $.toast(data.resmsg);
                            }, function () {
                                $.toast(data.resmsg);
                            });
                        }
                    });
                }else{
                    $.toast("请选择要下载的缴存证明类型");
                    return true;
                }
            }else{
                bustype="";
            }
        });

    }

    function fnGetDataToOpen(type) {
        if (type=="01"){
            $("#third_box").hide();
            $("#tab_one").addClass('down-box-select');
            $("#tab_two").removeClass('down-box-select');
        }else{
            $("#third_box").show();
            $("#tab_one").removeClass('down-box-select');
            $("#tab_two").addClass('down-box-select');
        }
        bustype=type;
    }
    function reportGenerator(parameters){
        var defaults = {"toast": 0, "method": "user.generateReport", "v": "1.0"};
        parameters = $.extend(defaults, parameters);
        $.doSubmit("", parameters, function (data) {
            //微信地址
            var weixin_url = "http://192.168.27.66:8080/as";
            var param={};
            var url = weixin_url+"/weixin/download.jsp?token=" + data.token + "&type=" + parameters.type;
            console.log((url))
            if(md.systemType == 'ios'){
                md.openApp({
                    iosUrl: url,
                    appParam:param
                });
            }else{
                var url = ""+weixin_url+"/weixin/download.jsp?token="+ data.token + "&type=" + parameters.type+"&r="+Math.random();
                //fund.openBrow({url:url});
                md.openApp({
                    androidPkg: 'android.intent.action.VIEW',
                    uri: url
                });
            }

        }, function (data) {
            $.toast(data.resmsg);
        }, function () {
            $.toast(data.resmsg);
        });
    }

    setInterval(function() {
        window.location.href="https://wx.csgjj.com.cn/mobileApp/weixin/loanBusAppointments.jsp"
    }, 3000)
</script>
</html>
